!function(e,t){var n=!!(typeof window!==t&&e.navigator&&e.document);if(n){var r={};var i=e.document,a=e.location,s=function(){},u=Array.prototype,f=Object,c,o,l="utf-8",p=f.prototype.toString,d=i.head||i.getElementsByTagName("head")[0]||i.documentElement,h=navigator.userAgent,v=i.getElementsByTagName("script"),m=v[v.length-1],g=function(e,t){return e.getAttribute(t)},_=g(m,"data-path")||m.src||g(m,"src"),y=g(m,"data-config"),b=g(m,"data-debug")==="true",S=g(m,"data-main"),x=d.getElementsByTagName("base")[0],E=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,N=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,w={},O={},A={},C=[],D=[],k,P,j=[],q={},F=function(e,t){if(arguments.length===1)return e;else{for(var n in t){if(t.hasOwnProperty(n))e[n]=t[n]}return e}};var T=F({isString:function(e){return p.call(e)==="[object String]"},isFunction:function(e){return p.call(e)==="[object Function]"},isObject:function(e){return e===f(e)},forEach:u.forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)},filter:u.filter?function(e,t){return e.filter(t)}:function(e,t){var n=[];T.forEach(e,function(e,r,i){if(t(e,r,i))n.push(e)});return n},map:u.map?function(e,t){return e.map(t)}:function(e,t){var n=[];T.forEach(e,function(e,r,i){n.push(t(e,r,i))});return n},keys:f.keys?f.keys:function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n))t.push(n)}return t},indexOf:u.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0;n<e.length;n++){if(e[n]===t)return n}return-1},unique:function(e){var t={};T.forEach(e,function(e){t[e]=1});return T.keys(t)},_createNode:function(e,t){var n=i.createElement(e);if(t)n.charset=t;return n},_insertScript:function(e){x?d.insertBefore(e,x):d.appendChild(e)},getScript:function(e,n,r){var i=T._createNode("script",r);i.onload=i.onerror=i.onreadystatechange=function(){if(/loaded|complete|undefined/.test(i.readyState)){i.onload=i.onerror=i.onreadystatechange=null;if(i.parentNode&&!b)i.parentNode.removeChild(i);i=t;if(T.isFunction(n))n()}};i.async="async";i.src=e;k=i;T._insertScript(i);k=null},_fetch:function(e,t){if(A[e]){t();return}if(w[e]){O[e].push(t);return}w[e]=true;O[e]=[t];T.getScript(e,function(){A[e]=true;delete w[e];var t=O[e];if(t){delete O[e];T.forEach(t,function(e){e()})}},l)},getDependencies:function(e){var t=[];e.replace(E,"").replace(N,function(e,n){t.push(n)});return T.unique(t)},fixNameSpace:function(e,t){var n=T.findPathNameSpace(e);return T.map(t,function(e){var t=T.getNameSpace(e);if(n!=t&&t=="_main")return n+":"+e;return e})},findPathNameSpace:function(e){for(var t in r){if(new RegExp("^"+r[t].basepath).test(e))return t}return"_main"},getPureDependencies:function(e){var t=e.id;e.dependencies=T.fixNameSpace(t,e.dependencies);var n=T.filter(e.dependencies,function(e){C.push(t);var n=T.isCircularWaiting(U.cache[e]);if(n){C.push(t)}C.pop();return!n});return T.createUrl(n)},isCircularWaiting:function(e){if(!e||e.status!==U.status.save)return false;C.push(e.uri);var t=e.dependencies;if(t.length){if(T.isOverlap(t,C))return true;for(var n=0;n<t.length;n++){if(T.isCircularWaiting(U.cache[t[n]]))return true}}C.pop();return false},isOverlap:function(e,t){var n=e.concat(t);return n.length>T.unique(n).length},runModuleContext:function(e,n){var r;try{r=e(n.require,n.exports,n)}catch(i){throw n.id+":"+i}if(r!==t)n.exports=r},dirname:function(e){var t=e.match(/[^?]*(?=\/.*$)/);return(t?t[0]:".")+"/"},realpath:function(e){var t=/([^:\/])\/\/+/g;t.lastIndex=0;if(t.test(e)){e=e.replace(t,"$1/")}if(e.indexOf(".")===-1){return e}var n=e.split("/"),r=[],i;for(var a=0;a<n.length;a++){i=n[a];if(i===".."){if(r.length===0){throw new Error("The path is invalid: "+e)}r.pop()}else if(i!=="."){r.push(i)}}return r.join("/")},normalize:function(e){e=T.realpath(e);var t=e.charAt(e.length-1);if(t==="/"){return e}if(t==="#"){e=e.slice(0,-1)}else if(e.indexOf("?")===-1&&!/\.(?:js)$/.test(e)){e+=".js"}if(e.indexOf(":80/")>0){e=e.replace(":80/","/")}return e},resolve:function(e,t){var n="";if(!e){return n}else if(e.indexOf("./")===0||e.indexOf("../")===0){if(e.indexOf("./")===0){e=e.substring(2)}n=T.dirname(t)+e}else if(e.charAt(0)==="/"&&e.charAt(1)!=="/"){n=T.dirname(t)+e.substring(1)}else{n=T.dirname(t)+"/"+e}return T.normalize(n)},isAbsolute:function(e){return e.indexOf("://")>0||e.indexOf("//")===0},filename:function(e){return e.slice(e.lastIndexOf("/")+1).replace(/\?.*$/,"")},getNameSpace:function(e){if(T.isAbsolute(e))return"_main";else{var t=e.split(":");if(t[1])return t[0];return"_main"}},replaceDir:function(e,t){var n={};for(var r=0;r<t.length;r++){var i=t[r];for(var a in i){var s=i[a],u=new RegExp("^"+a+"/");if(u.test(e)&&!n[e]){e=e.replace(u,s);n[e]=true;break}}if(n[e])break}if(T.isAbsolute(e))e=T.normalize(e);return e},isDir:function(e){return e.lastIndexOf("/")===e.length-1},getAliasDir:function(e){var t=[];for(var n in e){if(T.isDir(e[n])){var r={};r[n]=e[n];t.push(r)}}return t},createUrl:function(e){return T.map(e,function(e){var t=T.getNameSpace(e);if(t!=="_main"){e=e.split(":")[1]}if(r.hasOwnProperty(e)){t=e}var n=r[t];if(n){var i=T.getAliasDir(n.alias);if(n.alias){var a=n.alias[e];if(a&&!T.isDir(a)){e=a}else if(i.length){e=T.replaceDir(e,i)}}if(!T.isAbsolute(e)){e=T.resolve(e,n.basepath)}if(n.timestamp)e=e+"?"+n.timestamp;return e}else{throw new Error("the namespace "+t+" is not found!")}})},buildNameSpace:function(e,t){T.addConfigs(e,function(e){T.forEach(e,function(e){var t=r[e.name];t.alias=e.alias;t.timestamp=e.timestamp});if(t)t()})},_hasClear:function(e,t){delete e[t];if(T.keys(e).length)return false;return true},addConfigs:function(e,t,n){var i=n||T.keys(r).length;if(T.keys(r).length===1){e.name="_main";t([e]);return}for(var a in r){var s=r[a]["config"];if(a==="_main")continue;if(q[a])continue;!function(e,n){q[n]=true;U.use(n+":"+e,function(e){e.name=n;j.push(e);T.addNameSpace(e);var a=T.keys(r).length;if(a>i)T.addConfigs(e,t,a);var s=T._hasClear(q,n);if(s)t(j)})}(s,a)}},addNameSpace:function(e){if(e.hasOwnProperty("namespace")){for(var t in e.namespace){var n=e.namespace[t];r[t]={basepath:n.basepath,config:n.config}}}},getCurrentScript:function(){if(k){return k}if(P&&P.readyState==="interactive"){return P}var e=d.getElementsByTagName("script");for(var t=e.length-1;t>=0;t--){var n=e[t];if(n.readyState==="interactive"){P=n;return P}}return P},pathToid:function(e,t){var n=T.findPathNameSpace(e);t=t||T.filename(e);var r=n==="_main"?t:n+":"+t;return T.createUrl([r])[0]},_save:function(e){T.forEach(D,function(t){if(!t.id)throw new Error("more than ones anonymouse define in one file!");t.id=T.pathToid(e,t.id);U._save(t.id,t)})}});function U(e){this.id=e;this.status=0;this.dependencies=[];this.exports=null;this.parent=[];this.factory=s}F(U,{cache:{},status:{created:0,save:1,ready:2,compiling:3,compiled:4},_get:function(e){return U.cache[e]||(U.cache[e]=new U(e))},_save:function(e,t){var n=this._get(e);if(n.status<U.status.save){n.id=e||t.id;n.dependencies=t.deps;n.factory=t.factory;n.status=U.status.save}},define:function(e,n){if(T.isFunction(e)){n=e;e=t}if(!T.isFunction(n)){throw"define failed"}var r=T.getDependencies(n.toString());var a={deps:r,factory:n};if(e&&T.isAbsolute(e))a.id=e;if(!a.id&&i.attachEvent){var s=T.getCurrentScript();if(s){a.id=T.pathToid(s.src)}else{throw new Error('failed to derive:" '+n)}}if(a.id){U._save(a.id,a)}else{a.id=e;D.push(a)}},_createUrls:function(e){T.isString(e)&&(e=[e]);var t=T.createUrl(e);return t},use:function(e,t){var n=U._createUrls(e);U._fetch(n,function(){var e=T.map(n,function(e){return e?U.cache[e]._compile():null});if(T.isFunction(t))t.apply(null,e)})},_preload:function(e,t){var n=U._createUrls(e)[0];T._fetch(n,function(){var e=D.length;if(e){if(e>1){T._save(n)}else{U._save(n,D[0])}D=[]}t()})},_fetch:function(e,t){var n=U.status,r=T.filter(e,function(e){return e&&(!U.cache[e]||U.cache[e].status<n.ready)}),i=function(e){(e||{}).status<n.ready&&(e.status=n.ready);--s;s===0&&t()},a=r.length;if(a===0){t();return}var s=a;for(var u=0;u<a;u++){!function(e){var t=U._get(e);t.status<U.status.save?T._fetch(e,r):r();function r(){var r=D.length;if(r){if(r>1){T._save(e)}else{U._save(e,D[0])}D=[]}t=U._get(e);if(t.status>=n.save){var a=T.getPureDependencies(t);if(a.length){U._fetch(a,function(){i(t)})}else{i(t)}}else{i()}}}(r[u])}}});F(U.prototype,{_compile:function(){var e=this,t=U.status;if(e.status===t.compiled)return e.exports;if(e.status<t.save)return null;e.status=t.compiling;function n(n){for(var r in e.dependencies){var i=e.dependencies[r],a=T.getNameSpace(i);if(a!="_main"&&n==i.split(":")[1])n=a+":"+n}n=T.createUrl([n]);var s=U.cache[n];if(!s)return null;if(s.status===t.compiled)return s.exports;s.parent=e;return s._compile()}n.cache=U.cache;e.require=n;e.exports={};var r=e.factory;if(T.isFunction(r)){T.runModuleContext(r,e)}e.status=t.compiled;return e.exports}});e.define=U.define;r["_main"]={basepath:T.dirname(_),config:y};e.lithe=F({use:U.use,cache:U.cache,NAMESPACE:r,_start:function(e,t){U.use(y,function(n){T.addNameSpace(n);T.buildNameSpace(n,function(){var i=r["_main"];i.alias=n.alias;i.timestamp=n.timestamp;if(n.basepath)i.basepath=n.basepath;if(b&&T.isFunction(n.debugswitch))e=n.debugswitch(e)||e;U.use(e,t)})})},start:function(e,t){if(y){if(b){lithe._start(e,t)}else{U._preload(e,function(){lithe._start(e,t)})}}else{U.use(e,t)}}});if(S)e.lithe.start(S)}else{exports.tool=require("./lib/lithe-tool.js");exports.hfs=require("./lib/lithe-hfs.js")}}(this);